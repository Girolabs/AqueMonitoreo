
{% extends "base.html" %}
{% load staticfiles %}
{% load date_filter %}
{% block content%}

<style type="text/css">
.progress .progress-bar.progress-bar-amarillo {
    background-color: #FFE422;
}

.nav-tabs.ejes{
    background: #f47a2f;
}

.nav-tabs.visualizacion{
    background: #9E9E9E;
}


.treemap {
  width: 100%;
  height: 300px;
  background: #ddd;
}

.treemap text {
  pointer-events: none;
}

.treemap .grandparent text {
  font-weight: bold;
}

.treemap rect {
  fill: none;
  stroke: #fff;
}

.treemap rect.parent,
.grandparent rect {
  stroke-width: 2px;
}

.treemap .grandparent rect {
  fill: #f47a2f;
}

.treemap .grandparent:hover rect {
  fill: #ee9700;
}

.treemap .children rect.parent,
.treemap .grandparent rect {
  cursor: pointer;
}

.treemap .children rect.parent {
  fill: #bbb;
  fill-opacity: .5;
}

.treemap .children:hover rect.child {
  fill: #bbb;
}


.btn.black{
    background: #2e2e2e !important;
    color: white !important;
}


.btn-granate {

  background: #99113c;color: white !important;

}

.btn.btn-raised.btn-granate,.btn.btn-raised.btn-granate:hover, .btn.btn-raised.btn-granate:focus {
    background: rgba(153, 17, 60, 0.58);
}
</style>

    <!-- Main jumbotron for a primary marketing message or call to action -->

      <div class="container intro">

        <div class="col-md-4">

            <div class="col-md-12">
                <label for="select111" class="col-md-3 control-label">ELEGI TU CIUDAD</label>
                <div class="col-md-9">
                  <select id="select111" class="">

                  	{% for distrito in lista_distrito %}
                  			<option value="{{distrito.url}}" {% if distrito.url == distrito_principal.url %} selected {% endif%}> {{distrito.nombre}} </option>
                  	{% endfor %}
                    
                    
                  </select>
                </div>
              <span class="material-input"></span>
            </div>

            <div class="col-md-12">
                <label for="selectanio" class="col-md-3 control-label">Año de control</label>

                <div class="col-md-9">
                  <select id="selectanio" class="">
                    
                        <option value="2016" > 2016 </option>
                        <option value="2017" selected> 2017 </option>
                  </select>
                </div>
              <span class="material-input"></span>
            </div>

            <div class="col-md-12">
               <!-- <a href="javascript:void(0)" class="btn btn-raised btn-sm" style="background: #99113c;color: white; ">Ver hitorial Presupuesto y Ejecucion</a> -->
            </div>

        </div> 


      
        <div class="col-md-8">
          <div class="col-md-4">           
              <img src="http://www.aquieneselegimos.org.py/images/logo.png" class="img-responsive">
          </div>
          <div class="col-md-8">
             <h1  id="titulo" class="">Monitoreo Municipal</h1>
            <p>Línea de Base monitoreadas por la Sociedad Civil</p>
            <h2> <b> {{distrito_principal.dias_poder}}/{{distrito_principal.porcentaje_dias}} días</b> de Gestión</h2>
          </div>
        </div> 

        <div class="row">
                <div class="col-md-12">
                
              {% if presupuestos   %}
                  <h2 class="main-title">Gastos y Presupuestos Municipales</h2>

                        {% for presupuesto in presupuestos %}
                              {% if presupuesto.tipo_presupuesto == "ingresos" %}
                                     <button class="btn btn-sm btn-granate ingresos vis-boton" data-archivo="{{presupuesto.documento_csv.url}}" data-pdf="{% if presupuesto.document_pdf%}{{presupuesto.document_pdf.url}}{% endif %}"> Ingresos</button>
                              {% endif %}
                              
                              {% if presupuesto.tipo_presupuesto == "por_rubro" %}
                                    <button class="btn btn-sm  btn-granate rubro vis-boton " data-archivo="{{presupuesto.documento_csv.url}}" data-pdf="{% if presupuesto.document_pdf%}{{presupuesto.document_pdf.url}}{% endif %}"> Presupuesto por Rubro</button>
                              {% endif %}
                              


                              {% if presupuesto.tipo_presupuesto == "por_programa" %}
                                   <button class="btn btn-sm btn-granate programa vis-boton"  data-archivo="{{presupuesto.documento_csv.url}}" data-pdf="{% if presupuesto.document_pdf%}{{presupuesto.document_pdf.url}}{% endif %}"> Presupuesto por Programa</button>
                              {% endif %}
                        {% endfor %}
                  <div class="treemap" id="treemap"></div>
                  <a href="" class="download"> <button class="btn btn-sm black " > Descargar Datos</button></a>
                  <a href="" class="download-pdf"> <button class="btn btn-sm black " > Descargar Reporte Oficial</button></a>
              {% endif %}
                




                </div>  
        </div>

    </div>
 

    <div class="container">
      <div class="row">
      <div class="col-md-12">

       {% if lista_eje %}
        <h2 class="main-title">Monitoreo Municipal</h2>
          <a href="javascript:void(0)" class="btn btn-raised btn-sm black toggle-logrado">Mostrar No Logrados</a>
            <a href="javascript:void(0)" class="btn btn-raised btn-sm black toggle-nologrado">Mostar Logrados</a>

			    <ul class="nav nav-tabs ejes nav-justified">
			    {% for eje in lista_eje  %}
			        <li {% if forloop.first %} class="active" {% endif %} >

			           <a href="#{{ eje.id }}" data-toggle="tab">
			              <div class="imagen-tab"><img class="icono-tab"src="{{eje.imagen.url}}"></div> 
			              {{eje.nombre}} 
						      </a>
			        </li>
			    {% endfor %}
			    </ul>
			{% endif %}

          <div id="myTabContent" class="tab-content">


            

          	{% if lista_eje %}

          	{% for eje in lista_eje  %}
          		
          				
          						<div class="tab-pane fade {% if forloop.first %} active in {% endif %} " id="{{eje.id}}">
          								<table class="table table-striped table-hover ">
                           
                                          <thead>
	                                          <tr>
	                                        
	                                            <th>Pregunta</th>
	                                            <th >Logrado?</th>
	                                           
	                                          </tr>
                                          </thead>
                                          <tbody>
                                    {% for pregunta in lista_pregunta %}

                                         {% if pregunta.eje == eje %}

                                          <tr 

                                            {% if pregunta.estado == "Aprobado" %}
                                                      class="success {{ pregunta.anio| date:'Y'}}"
                                                  {% elif pregunta.estado == "No aprobado" %}
                                                      class="danger {{ pregunta.anio| date:'Y'}}"
                                                  {% else %}
                                                      remove
                                                  {% endif %}



                                          >
                                          <!--  <td>{{forloop.counter }}</td> -->
                                            <td> <p><b>{{pregunta.pregunta | capfirst}}</b> </p>
                                            	<p> {{pregunta.respuesta |safe }} </p>
                                              
                                            </td>
                                           

                                              <td class="estado">

                                              <i class="material-icons">
                                                  {% if pregunta.estado == "Aprobado" %}
                                                      done
                                                  {% elif pregunta.estado == "No aprobado" %}
                                                      clear
                                                  {% else %}
                                                      remove
                                                  {% endif %}
                                              </i>

                                               {% if pregunta.articulos.all  %}

                                                {% for articulo in pregunta.articulos.all %}
                                                         <a href="/articulo/{{ articulo.link }}/" class="btn btn-raised btn-primary btn-xs"> Ver Detalles 
                                                 
                                              </a>
                                                  {% endfor %}
                                             
                                              {% endif %}
                                            </td>

                                            
                                          </tr>
                                           {% endif %}

    
                                          {% endfor %}
                                         
                                         
                                          </tbody>
                                        </table>
          						</div>


          				

          		
          	{% endfor %}
          	{% endif %}

           
            
          </div>

          </div>
      </div>  

      <hr>
      <!-- Example row of columns -->
      <div class="row">
        <div class="col-md-8">

          {{config.QUIENES_SOMOS_PORTADA |safe}}

         
        </div>
       
        <div class="col-md-4">

          {{config.QUIEN_NOS_AYUDA |safe}}
          
        
        </div>
      </div>


{% endblock %}




    {% block footer %}




       <script src="{% static 'js/underscore.min.js' %}"></script>
     <script src="{% static 'js/d3.min.js' %}"></script>


    <!--- El Purete treemap2-->

<script type="text/javascript">

anio = {{ anio }}
 








    $( "#sel2" ).change(function(){


$("#treemap .depth").remove();
Treemap($('#sel2 option:selected').text());
   


   $(".rubro").click( function(){

 

   }  )


   
});


    

</script>



        <script src="{% static 'js/treemap-programa.js' %}"></script>

 <script type="text/javascript">
$( document ).ready(function() {

//Treemap2("2015","{{distrito_principal.nombre | lower}}_presupuesto_programa_2017", "#treemap");  
//$(".download").attr("href", "/static/{{distrito_principal.nombre | lower}}_presupuesto_programa_2017.csv")

anio = {{anio}}
/*
$(".programa").click(function(){
    console.log("programa");
    $("#treemap").html("");
    $(".btn-granate").removeClass("btn-raised");
    $(this).addClass("btn-raised");
      Treemap2("2015","{{distrito_principal.nombre | lower}}_presupuesto_programa_2017", "#treemap");   

      $(".download").attr("href", "/static/{{distrito_principal.nombre | lower}}_presupuesto_programa_2017.csv")
   
  });

$(".ingresos").click(function(){
    console.log("ingresos");
    $("#treemap").html("");
    $(".btn-granate").removeClass("btn-raised");
    $(this).addClass("btn-raised");
    Treemap2("2015","{{distrito_principal.nombre | lower}}_presupuesto_ingresos_2017", "#treemap");  
   $(".download").attr("href", "/static/{{distrito_principal.nombre | lower}}_presupuesto_ingresos_2017.csv") 
   
  });

$(".rubro").click(function(){
    console.log("rubro");
    $("#treemap").html("");
    $(".btn-granate").removeClass("btn-raised");
    $(this).addClass("btn-raised");
     Treemap2("2015","{{distrito_principal.nombre | lower}}_presupuesto_rubro_2017", "#treemap");
      $(".download").attr("href", "/static/{{distrito_principal.nombre | lower}}_presupuesto_rubro_2017.csv")  
   
  })
*/



$(".vis-boton").click(function(){
   
    $("#treemap").html("");
    $(".btn-granate").removeClass("btn-raised");
    $(this).addClass("btn-raised");
    archivo_csv = $(this).data("archivo");
    archivo_pdf =$(this).data("pdf");
      Treemap2(anio, archivo_csv , "#treemap");   

      $(".download").attr("href", archivo_csv)
        $(".download-pdf").attr("href", archivo_pdf)
   
  });

$(".vis-boton").first().addClass("btn-raised");
Treemap2(anio,$(".vis-boton").first().data("archivo"), "#treemap");  
$(".download").attr("href", $(".vis-boton").first().data("archivo"))


        $(".download-pdf").attr("href", $(".vis-boton").first().data("pdf"))


});// END CONSOLE READY



 </script>




      {% endblock %}